{% extends "index.html" %}
{% block title %}ìƒí’ˆ êµ¬ë§¤ í˜ì´ì§€{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/purchase.css') }}">

<div class="purchase-container">
Â  Â  <h2 class="purchase-title">ìƒí’ˆ êµ¬ë§¤</h2>

Â  Â  <div class="product-info-summary">
Â  Â  Â  Â  <p class="product-name">êµ¬ë§¤ ìƒí’ˆ: <strong>{{ product.name }}</strong></p>
Â  Â  Â  Â  
Â  Â  Â  Â  <p class="product-price" data-base-price="{{ product.price | int }}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ë‹¨ê°€: â‚©<span id="base-price-display">{{ product.price | format_price }}</span>
Â  Â  Â  Â  </p>
Â  Â  </div>

Â  Â  <hr>

Â  Â  <div class="quantity-control">
Â  Â  Â  Â  <label for="quantity">êµ¬ë§¤ ìˆ˜ëŸ‰:</label>
Â  Â  Â  Â  <div class="control-group">
Â  Â  Â  Â  Â  Â  <button class="quantity-btn minus-btn" onclick="updateQuantity(-1)">-</button>
Â  Â  Â  Â  Â  Â  <input type="number" id="quantity" value="1" min="1" readonly>
Â  Â  Â  Â  Â  Â  <button class="quantity-btn plus-btn" onclick="updateQuantity(1)">+</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="total-amount">
Â  Â  Â  Â  <p>ì´ ê²°ì œ ê¸ˆì•¡:</p>
Â  Â  Â  Â  <p class="amount-value">â‚©<span id="total-amount-display">{{ product.price | format_price }}</span></p>
Â  Â  </div>

Â  Â  Â  Â  <button class="btn confirm-btn" onclick="confirmPurchase()">êµ¬ë§¤ í™•ì •</button>

</div>

<script>
Â  Â  // app.pyì˜ ë¼ìš°íŠ¸ì—ì„œ 'product.price'ê°€ ì´ë¯¸ intë¡œ ë³€í™˜ë˜ì–´ ë„˜ì–´ì˜¨ë‹¤ê³  ê°€ì •
Â  Â  const basePrice = parseFloat(document.querySelector('.product-price').dataset.basePrice);
Â  Â  const quantityInput = document.getElementById('quantity');
Â  Â  const totalAmountDisplay = document.getElementById('total-amount-display');

Â  Â  // ìˆ«ìì— ì‰¼í‘œ í¬ë§·ì„ ì ìš©í•˜ëŠ” í•¨ìˆ˜ (JavaScriptìš©)
Â  Â  function formatNumber(num) {
Â  Â  Â  Â  return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
Â  Â  }

Â  Â  // ìˆ˜ëŸ‰ ë³€ê²½ ë° ì´ ê¸ˆì•¡ ì—…ë°ì´íŠ¸
Â  Â  function updateQuantity(change) {
Â  Â  Â  Â  let currentQty = parseInt(quantityInput.value);
Â  Â  Â  Â  let newQty = currentQty + change;

Â  Â  Â  Â  if (newQty < 1) {
Â  Â  Â  Â  Â  Â  newQty = 1; // ìµœì†Œ ìˆ˜ëŸ‰ 1
Â  Â  Â  Â  }

Â  Â  Â  Â  quantityInput.value = newQty;
Â  Â  Â  Â  updateTotalAmount(newQty);
Â  Â  }

Â  Â  // ì´ ê¸ˆì•¡ ê³„ì‚° ë° í‘œì‹œ ì—…ë°ì´íŠ¸
Â  Â  function updateTotalAmount(qty) {
Â  Â  Â  Â  const total = basePrice * qty;
Â  Â  Â  Â  totalAmountDisplay.textContent = formatNumber(total);
Â  Â  }

Â  Â  // ğŸš¨ ìµœì¢… í™•ì • ë²„íŠ¼ ë¡œì§ (ëª¨ë‹¬ ì—†ì´ ë°”ë¡œ ì‹¤í–‰)
Â  Â  function confirmPurchase() {
Â  Â  Â  Â  const product_name = document.querySelector('.product-name strong').textContent;
Â  Â  Â  Â  const currentQty = parseInt(quantityInput.value);
Â  Â  Â  Â  const currentTotal = basePrice * currentQty;

Â  Â  Â  Â  alert(`ğŸ‰ êµ¬ë§¤ê°€ í™•ì •ë˜ì—ˆìŠµë‹ˆë‹¤!\nìƒí’ˆ: ${product_name}\nìˆ˜ëŸ‰: ${currentQty}ê°œ\nì´ ê¸ˆì•¡: â‚©${formatNumber(currentTotal)}`); 
Â  Â  Â  Â  
Â  Â  Â  Â  // ì—¬ê¸°ì— êµ¬ë§¤ ì™„ë£Œ í›„ ì´ë™í•  í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰ì…˜ ë¡œì§ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
Â  Â  Â  Â  // ì˜ˆ: window.location.href = '/feature-list'; 
Â  Â  }
Â  Â  
Â  Â  // ğŸš¨ ëª¨ë‹¬ ê´€ë ¨ JavaScript í•¨ìˆ˜ ë° window.onclick ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ëª¨ë‘ ì‚­ì œë¨
</script>
{% endblock %}